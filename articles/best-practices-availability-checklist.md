<properties
   pageTitle="Liste de contrôle de disponibilité | Microsoft Azure"
   description="Liste de contrôle fournissant des indications relatives aux problématiques de disponibilité durant la conception."
   services=""
   documentationCenter="na"
   authors="dragon119"
   manager="masimms"
   editor=""
   tags=""/>

<tags
   ms.service="best-practice"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="04/28/2015"
   ms.author="masashin"/>

# Liste de contrôle de disponibilité

![](media/best-practices-availability-checklist/pnp-logo.png)

## Conception des applications

- **Évitez tout point de défaillance.** L’ensemble des instances de composants, de services, de ressources et de calcul doivent être déployées en tant qu’instances multiples afin d’empêcher qu’un point de défaillance unique affecte la disponibilité du système. Cela concerne les mécanismes d’authentification. Concevez l’application afin qu’elle puisse être configurable pour l’utilisation de plusieurs instances et pour la détection automatique des défaillances, ainsi que pour la redirection des requêtes vers les instances non défaillantes dans les situations où la plateforme n’effectue pas automatiquement cette action.
- **Décomposez la charge de travail par contrat de niveau de service.** Si un service est composé de charges de travail critiques et moins critiques, gérez-les de manière distincte et définissez les fonctions de service et le nombre d’instances nécessaires à la satisfaction de leurs exigences de disponibilité.
- **Réduisez et comprenez les dépendances de services.** Dans la mesure du possible, réduisez le nombre de services utilisés et assurez-vous de comprendre l’ensemble des dépendances de fonctions et de services existant dans le système. Il s’agit notamment de la nature de ces dépendances et de l’incidence des défaillances ou de la réduction des performances respectives dans l’application. Microsoft garantit une disponibilité minimale de 99,9 % pour la plupart des services, mais cela signifie que chaque service supplémentaire sur lequel s’appuie l’application réduit le contrat global de niveau de service de disponibilité de votre système de 0,1 %.
- **Dans la mesure du possible, concevez des tâches et des messages idempotents**, de manière à ce que les requêtes ne provoquent pas de problèmes. Par exemple, un service peut jouer le rôle de consommateur traitant les messages envoyés en tant que requêtes par d’autres parties du système qui agissent comme producteurs. Si le consommateur échoue après le traitement du message, mais avant la confirmation de son traitement, un producteur peut soumettre une requête de répétition pouvant être traitée par une autre instance du consommateur. Pour cette raison, les consommateurs et les opérations qu’ils exécutent doivent être idempotentes, de manière à ce que la réitération d’une opération exécutée auparavant n’invalide pas les résultats. Cela peut impliquer la détection des messages dupliqués ou la garantie de la cohérence à l’aide d’une approche optimiste de traitement des conflits.
- **Utilisez un Service Broker de message qui implémente une haute disponibilité pour les transactions critiques.** De nombreux scénarios de lancement de tâches ou d’accès à des services à distance utilisent la messagerie pour communiquer des instructions entre l’application et le service cible. Pour des performances optimales, l’application doit pouvoir envoyer le message, puis être de nouveau disponible pour le traitement de requêtes supplémentaires sans attendre une réponse. Pour garantir la remise des messages, le système de messagerie doit proposer une haute disponibilité. Les files d’attente de messagerie de Microsoft Azure Service Bus implémentent _au moins une fois_ la sémantique. Ici, chaque message publié sur une file d’attente ne sera pas perdu, même si des copies dupliquées peuvent être transmises dans certains cas. Si le traitement des messages est idempotent (voir l’élément précédent), la livraison répétée ne doit poser aucun problème.
- **Configurez la dégradation appropriée des applications** lorsque les limites de ressources sont atteintes et prenez les mesures qui s’imposent pour réduire l’impact sur l’utilisateur. Dans certains cas, la charge sur l’application peut dépasser la capacité d’une ou plusieurs portions, ce qui entraîne une réduction de la disponibilité et la mise en échec des connexions. La mise à l’échelle peut aider à pallier ces problématiques, mais vous pouvez vous heurter à des restrictions de disponibilité de ressources ou de coûts. Concevez l’application de telle sorte que, dans cette situation, elle puisse automatiquement se dégrader de manière appropriée. Par exemple, dans un système de commerce électronique, si le sous-système de traitement des commandes est sous contrainte (ou a subi une défaillance complète), vous pouvez le désactiver temporairement, tout en permettant à une autre fonctionnalité (comme la consultation du catalogue de produits) de continuer à s’exécuter. Il peut être utile de reporter les requêtes dirigées vers un sous-système défaillant. Par exemple, vous pouvez autoriser les clients à soumettre les commandes, tout en enregistrant ces dernières dans une file d’attente ou un autre mécanisme de stockage sécurisé et programmer leur traitement lors de la remise à disposition du sous-système de traitement des commandes.
- **Traitez de manière appropriée les événements de rafales rapides.** La plupart des applications doivent gérer des charges de travail variables au fil du temps. Ainsi, elles sont par exemple soumises aux pics d’une application commerciale dès le matin ou doivent gérer l’effort requis par le lancement d’un nouveau produit sur un site de commerce électronique. La mise à l’échelle automatique peut aider à traiter la charge, mais la mise en ligne des instances supplémentaires dédiées au traitement des requêtes peut prendre un certain temps. Empêchez les rafales soudaines et imprévues d’activité de surcharger l’application en les définissant sur les requêtes de file d’attente des services utilisés et en configurant leur dégradation lorsque la capacité maximale des files d’attente est proche d’être atteinte. Veillez à conserver des niveaux appropriés de performances et de capacité dans des conditions normales, afin de traiter efficacement les files et de gérer les requêtes en attente. Pour en savoir plus, consultez le [Modèle de nivellement de charge basé sur la file d'attente](https://msdn.microsoft.com/library/dn589783.aspx).

## Déploiement et maintenance

- **Déployez plusieurs instances de rôles pour chaque service.** Microsoft offre des garanties de disponibilité pour les services que vous créez et déployez, mais ces garanties sont valides uniquement si vous déployez au moins deux instances de chaque rôle dans le service. Ainsi, un rôle est indisponible, tandis que l’autre demeure actif. Ceci est particulièrement important si vous avez besoin de déployer des mises à jour dans un système actif sans interrompre les activités des clients. Le cas échéant, les instances peuvent être retirées et mises à niveau individuellement, tandis que les autres restent en ligne.
- **Hébergez des applications dans plusieurs centres de données.** Même si c’est extrêmement improbable, il est possible qu’un centre de données soit mis intégralement hors ligne lors d’une catastrophe naturelle ou d’une défaillance de jonction Internet. Pour garantir une disponibilité optimale, vous devez héberger les applications commerciales critiques dans plus d’un centre de données. Cette mise en place permet par ailleurs de réduire la latence pour les utilisateurs locaux et offre une flexibilité supplémentaire lors des mises à jour d’applications.
- **Automatisez et testez les tâches de déploiement et de maintenance.** Les applications distribuées se composent de plusieurs parties qui doivent fonctionner ensemble. En conséquence, le déploiement doit être automatisé à l’aide de mécanismes testés et éprouvés, comme des scripts et des applications de déploiement qui mettent à jour et valident la configuration, et automatisent le processus de déploiement. Ces techniques automatisées doivent être également utilisées pour exécuter des mises à jour sur l’ensemble des applications, ou une partie d’entre elles. Il est essentiel de tester intégralement l’ensemble de ces processus, afin de garantir que les erreurs ne provoquent pas de temps d’arrêt supplémentaires. L’ensemble des outils de déploiement doivent présenter des restrictions appropriées de sécurité afin de protéger l’application déployée. Définissez et appliquez avec rigueur les stratégies de déploiement et réduisez le recours à l’intervention humaine.
- **Envisagez d’utiliser des fonctions de gestion intermédiaire et de production **, si disponibles. Par exemple, si vous recourez à des environnements de gestion intermédiaire et de production de Microsoft Azure Cloud Services, les applications peuvent être basculées d’un à l’autre via un échange d’adresses IP virtuelles. Toutefois, si vous préférez vous déployer sur site ou déployer différentes versions de l’application simultanément et migrer régulièrement les utilisateurs, il est possible que vous ne puissiez pas utiliser une opération d’échange d’adresses IP virtuelles.
- Dans la mesure du possible, **appliquez les modifications de configuration sans recycler** l’instance. Dans de nombreux cas, les paramètres de configuration d’une application ou d’un service Microsoft Azure peuvent être modifiés sans qu’il ne soit nécessaire de redémarrer le rôle. Les rôles exposent des événements qui peuvent être traités pour détecter les modifications de configuration et les appliquer aux composants de l’application. Néanmoins, certaines modifications des paramètres principaux de la plateforme nécessitent un redémarrage du rôle. Lors de la création de composants et de services, optimisez la disponibilité et réduisez les temps d’arrêt en configurant l’acceptation automatique des paramètres de configuration, sans qu’il ne soit nécessaire de redémarrer l’application.
- **Utilisez des domaines de mise à niveau pour éliminer les temps d’arrêt durant les mises à jour.** Les unités de calcul Microsoft Azure, comme les rôles Web et de travail, sont allouées aux domaines de mise à niveau. Les domaines de mise à niveau regroupent les instances de rôles. Ainsi, lorsqu’une mise à niveau propagée est exécutée, les rôles du domaine de mise à niveau sont arrêtés, mis à jour et redémarrés successivement, afin de réduire l’impact sur la disponibilité de l’application. Vous pouvez spécifier le nombre de domaines de mise à niveau à créer pour un service lors du déploiement de ce dernier.

	> [AZURE.NOTE]Les rôles sont également distribués au sein des domaines d’erreur, qui sont indépendants des autres domaines d’erreur en matière de rack de serveur, d’alimentation et d’approvisionnement de refroidissement. Cette configuration permet de réduire les probabilités de défaillances affectant l’ensemble des instances de rôles. Cette distribution se produit automatiquement ; vous n’avez aucun contrôle dessus.

- **Configurez les groupes à haute disponibilité des machines virtuelles Microsoft Azure.** En plaçant un minimum de deux machines virtuelles dans le même groupe à haute disponibilité, vous êtes certain qu’elles ne seront pas déployées dans le même domaine d’erreur. Pour optimiser la disponibilité, vous avez tout intérêt à créer plusieurs instances des machines virtuelles utilisées par votre système, et de placer ces instances dans le même groupe à haute disponibilité. Si vous exécutez plusieurs machines virtuelles exécutant différentes fonctions, créez un groupe à haute disponibilité pour chaque machine virtuelle et ajoutez des instances de ces machines dans chacun des groupes. Par exemple, si vous avez créé des machines virtuelles jouant le rôle de serveur Web ou de serveur de rapports, créez un groupe à haute disponibilité pour le serveur Web et un autre groupe à haute disponibilité pour le serveur de rapports. Ajoutez des instances de la machine virtuelle du serveur Web au groupe à haute disponibilité du serveur Web, et ajoutez des instances de la machine virtuelle du serveur de rapports au groupe à haute disponibilité du serveur de rapports.

## Gestion des données

- **Tirez parti de la réplication des données** via la redondance locale et géographique. Les données stockées à l’aide de Microsoft Azure Storage sont automatiquement répliquées afin de vous protéger contre les pertes en cas de défaillance de l’infrastructure, et certains facteurs de cette réplication peuvent être configurés. Par exemple, les copies en lecture seule de données peuvent être répliquées dans plus d’une région géographique (stockage géo-redondant globalement avec accès en lecture (RA-GRS)). Notez que l’utilisation de RA-GRS entraîne des frais supplémentaires. Pour en savoir plus, consultez la page de [tarification de Microsoft Azure Storage](http://azure.microsoft.com/pricing/details/storage/) du site Web Microsoft.
- Dans la mesure du possible, **utilisez l’accès concurrentiel optimiste et la cohérence éventuelle**. Les transactions qui bloquent l’accès aux ressources au moyen du verrouillage (accès concurrentiel optimiste) peuvent réduire sensiblement les performances et la disponibilité. Ces problèmes peuvent se révéler particulièrement sérieux au sein des systèmes distribués. Dans de nombreux cas, une conception et des techniques étudiées, comme le partitionnement, permettent de réduire la probabilité de conflits entre les mises à jour. Lorsque les données sont répliquées ou lues à partir d’un magasin mis à jour, elles seront en définitive cohérentes ; les avantages surpassent largement les effets négatifs sur la disponibilité provoqués par l’utilisation des transactions dans l’objectif de garantir la cohérence immédiate.
- **Utilisez la sauvegarde périodique et la limite de restauration dans le temps **, et assurez-vous que l’objectif de point de récupération est atteint. Sauvegardez de manière régulière et automatique les données qui ne sont conservées à aucun emplacement et vérifiez que vous pouvez récupérer les données et l’application en cas de défaillance. La réplication de données n’est pas une fonction de sauvegarde, car les incohérences et problèmes introduits via les défaillances, les erreurs ou les opérations malveillantes sont répliqués sur l’ensemble des magasins. Le processus de sauvegarde doit être sécurisé afin de protéger les données stockées et en transit. Les bases de données ou portions de magasins de données peuvent habituellement être récupérées à un point dans le temps, à l’aide de journaux de transactions. Microsoft Azure offre une installation de sauvegarde dédiée aux données stockées dans la base de données SQL Microsoft Azure. Les données sont exportées vers un package de sauvegarde dans l’espace de stockage d’objets Blob Microsoft Azure, et peuvent être téléchargées et stockées sur un emplacement local sécurisé.
- **Activez l’option de haute disponibilité afin de conserver une copie secondaire de Cache Redis.** Si vous recourez au Cache Redis, sélectionnez l’option Standard afin de conserver une copie secondaire du contenu. Pour en savoir plus, consultez la page [Créer un cache dans le Cache Redis Microsoft Azure](https://msdn.microsoft.com/library/dn690516.aspx) du site Web Microsoft.

## Erreurs et défaillances

- **Introduisez le concept de délai d’expiration.** Les services et les ressources peuvent devenir indisponibles, ce qui provoque l’échec des requêtes. Veillez à ce que les délais d’expiration appliqués sont appropriés pour chaque service ou ressource, ainsi que pour le client qui y accède (dans certains cas, il peut s’avérer judicieux d’allouer un délai d’expiration plus long à une instance de client, en fonction du contexte et des autres actions exécutées par le client). Des délais d’expiration très courts sont susceptibles d’entraîner l’exécution en excès de nouvelles tentatives pour les services et les ressources présentant une latence importante, mais des délais d’expiration très longs peuvent provoquer un blocage si un grand nombre de requêtes sont mises en attente de la réponse d’un service ou d’une ressource.
- **Réessayez les opérations mises en échec par des erreurs temporaires.** Concevez une stratégie de nouvelle tentative permettant d’accéder à l’ensemble des services et des ressources lorsque les tentatives de nouvelle connexion automatiques ne sont pas prises en charge par héritage. Valorisez une stratégie prévoyant un délai croissant entre les tentatives à mesure que le nombre de défaillances augmente, ceci pour éviter de surcharger la ressource, qui est alors en mesure de récupérer et traiter les requêtes mises en attente de manière appropriée. Les tentatives répétées dans des délais très courts auront probablement pour effet d’aggraver le problème.
- **Arrêtez d’envoyer des requêtes afin d’éviter les défaillances en cascade** durant l’indisponibilité des services à distance. Il peut survenir des situations ou des erreurs temporaires ou autres, allant d’une perte partielle de connectivité à la défaillance intégrale d’un service, nécessitent un délai plus long que prévu de retour à la normale. Par ailleurs, si un service est très occupé, une défaillance dans une portion du système peut générer des défaillances en cascade et conduire au blocage de différentes opérations lors de l’utilisation de ressources critiques du système comme la mémoire, les threads et les connexions aux bases de données. Au lieu de tenter à nouveau de relancer une opération qui ne va vraisemblablement pas réussir, l’application doit rapidement accepter que l’opération a été mise en échec et traiter de manière appropriée cette défaillance. Vous pouvez utiliser le modèle Disjoncteur pour rejeter les requêtes liées à des opérations spécifiques sur des périodes définies. La page consacrée au modèle [Disjoncteur](https://msdn.microsoft.com/library/dn589784.aspx) du site Web de Microsoft vous fournit davantage de détails.
- **Composez ou basculez vers plusieurs composants** afin de réduire l’impact de la mise hors ligne ou de l’indisponibilité d’un service spécifique. Concevez des applications afin de tirer parti de plusieurs instances sans affecter les opérations ou les connexions existantes, dans la mesure du possible. Utilisez plusieurs instances et distribuez les requêtes entre elles, détectez les instances défaillantes et évitez de leur envoyer des requêtes, ceci pour optimiser la disponibilité.
- Dans la mesure du possible, **revenez à un service ou workflow différent** Par exemple, si l’écriture vers une base de données SQL est mise en échec, stockez temporairement les données dans un espace de stockage d’objets Blob et fournissez une installation permettant de relancer les écritures de l’espace de stockage d’objets Blob vers la base de données SQL lorsque le service devient disponible. Dans certains cas, une opération mise en échec peut présenter une action alternative qui permet à l’application de continuer à fonctionner même quand un composant ou un service est défaillant. Si possible, détectez les défaillances et redirigez les requêtes vers d’autres services offrant une fonctionnalité appropriée acceptable ou vers la sauvegarde, ou réduisez les instances de fonctionnalités pouvant maintenir les opérations principales pendant que le service principal est hors ligne.

## Surveillance et récupération d’urgence

- **Proposez des instruments avancés dédiés aux défaillances courantes et aux événements de défaillance** afin de communiquer la situation au personnel en charge des opérations. Pour les défaillances qui ne sont probablement pas encore survenues, fournissez un volume suffisant de données afin de donner les moyens au personnel en charge des opérations d’identifier la cause, d’atténuer la situation et de garantir la disponibilité du système. Pour les défaillances qui se sont déjà produites, l’application doit renvoyer un message d’erreur approprié à l’utilisateur tout en essayant de continuer à s’exécuter, avec une fonctionnalité réduite. Dans tous les cas, le système de surveillance doit collecter des détails complets mis à profit par le personnel des opérations pour pratiquer une récupération rapide, et si nécessaire par les concepteurs et les développeurs pour modifier le système afin de prévenir toute nouvelle situation de ce type.
- **Surveillez l’intégrité du système en implémentant des fonctions de contrôle.** L’intégrité et les performances d’une application peuvent se dégrader au fil du temps, sans qu’aucun signe avant-coureur n’apparaisse avant la défaillance. Pour vous protéger contre cette dégradation, vous pouvez implémenter des sondes ou des fonctions de contrôle qui sont exécutées régulièrement à l’extérieur de l’application. Il peut s’agir d’une mesure simple du temps de réponse de l’application en tant qu’entité, de portions de l’application, des services utilisés par l’application ou de composants individuels. Les fonctions de contrôle peuvent exécuter des processus garantissant la validité des résultats produits, mesurer la latence, surveiller la disponibilité et extraire les informations du système.
- **Testez régulièrement les systèmes de basculement et de secours** afin de vous assurer de leur disponibilité et de leur bon fonctionnement. Les modifications apportées aux systèmes et aux opérations peuvent affecter les fonctions de basculement et de secours, mais les conséquences peuvent ne pas être détectées avant la défaillance ou la surcharge du système. Il est recommandé de procéder au test avant d’avoir recours aux systèmes pour pallier un problème au moment de l’exécution.
- **Testez les systèmes de surveillance.** Les systèmes automatisés de basculement et de secours, et la visualisation manuelle de l’intégrité et des performances du système à l’aide de tableaux de bord sont tributaires du bon fonctionnement des systèmes et des instruments de surveillance. Si ces éléments subissent des défaillances, laissent échapper des informations critiques ou signalent des données inexactes, l’opérateur peut ne pas avoir connaissance du défaut d’intégrité ou de la défaillance du système.
- **Suivez la progression des longs workflows ** et réessayez en cas d’échec. Les longs workflows sont bien souvent composés de plusieurs étapes. Lorsque vous concevez ces types de workflows, veillez à ce que chaque étape soit indépendante et puisse faire l’objet d’une nouvelle tentative afin de réduire la probabilité du recours à la restauration de l’intégralité du workflow ou à l’exécution de plusieurs transactions de compensation. Surveillez et gérez la progression des longs workflows en implémentant un modèle tel que Scheduler Agent Supervisor. Pour en savoir plus, consultez la page consacrée au [modèle Scheduler Agent Supervisor](https://msdn.microsoft.com/library/dn589780.aspx) du site Web Microsoft.
- **Plan de récupération d’urgence.** Assurez-vous de disposer d’un plan de récupération documenté, convenu et intégralement testé pour tout type de défaillance susceptible de rendre une partie ou l’intégralité du système indisponible. Éprouvez régulièrement les procédures afin de garantir que l’ensemble du personnel opérationnel maîtrise le processus.

<!---HONumber=July15_HO4-->