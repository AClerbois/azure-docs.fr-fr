---
title: Points de terminaison de streaming dans Azure Media Services | Microsoft Docs
description: Cet article explique ce que sont les points de terminaison de streaming et comment ils sont utilisés par Azure Media Services.
services: media-services
documentationcenter: ''
author: Juliako
manager: femila
editor: ''
ms.service: media-services
ms.workload: ''
ms.topic: article
ms.date: 10/16/2018
ms.author: juliako
ms.openlocfilehash: 5ba80df26731f9687ec4518d7f12f3c2e3cb0665
ms.sourcegitcommit: 3a7c1688d1f64ff7f1e68ec4bb799ba8a29a04a8
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/17/2018
ms.locfileid: "49379176"
---
# <a name="streaming-endpoints"></a>Points de terminaison de diffusion en continu

Dans Microsoft Azure Media Services (AMS), l’entité [Points de terminaison de streaming](https://docs.microsoft.com/rest/api/media/streamingendpoints) représente un service de streaming qui peut fournir du contenu directement à une application de lecteur cliente ou à un réseau de distribution de contenu (CDN) pour être redistribué. Le flux sortant d’un service de point de terminaison de streaming peut être un flux dynamique ou une ressource de vidéo à la demande dans votre compte Media Services. Quand vous créez un compte Media Services, un point de terminaison de streaming **par défaut** est créé pour vous dans l’état Arrêté. Vous ne pouvez pas supprimer le point de terminaison de streaming par défaut. Vous pouvez créer d’autres points de terminaison de streaming sous votre compte. Pour démarrer le streaming de vidéos, vous devez démarrer le point de terminaison de streaming. 

## <a name="streamingendpoint-types"></a>Types de points de terminaison de streaming  

Il existe deux types de **points de terminaison de streaming** : **Standard** et **Premium**. Le type est défini par le nombre d’unités d’échelle (`scaleUnits`) que vous allouez pour le point de terminaison de streaming. 

Le tableau décrit les types :  

|type|Unités d’échelle|Description|
|--------|--------|--------|  
|**Point de terminaison de streaming Standard** (recommandé)|0|Le type **Standard** est l’option recommandée pour pratiquement tous les scénarios de streaming et toutes les tailles d’audience. Le type **Standard** met automatiquement à l’échelle la bande passante sortante. <br/>Pour les clients avec des exigences extrêmement fortes, Media Services offre des points de terminaison de streaming **Premium**, qui peuvent être utilisés pour faire monter en charge la capacité pour les audiences Internet les plus étendues. Si vous attendez des audiences importantes et un grand nombre de visiteurs simultanés, contactez-nous à l’adresse amsstreaming@microsoft.com pour obtenir des conseils sur la nécessité de passer au type **Premium**. |
|**Point de terminaison de streaming Premium**|>0|Les points de terminaison de streaming **Premium** sont conçus pour les charges de travail avancées et fournissent une capacité de bande passante dédiée et scalable. Vous passez à un type **Premium** en ajustant les `scaleUnits`. Les `scaleUnits` vous offrent une capacité de sortie dédiée qui peut être achetée par incréments de 200 Mbits/s. Quand vous utilisez le type **Premium**, chaque unité activée fournit une capacité de bande passante supplémentaire à l’application. |

## <a name="working-with-cdn"></a>Utilisation avec un CDN

Dans la plupart des cas, un CDN doit être activé. Cependant, si vous prévoyez un nombre maximal d’accès simultanés inférieur à 500 visiteurs, il est recommandé de désactiver le CDN, car celui-ci se met à l’échelle de façon optimale avec les accès simultanés.

### <a name="detailed-explanation-of-how-caching-works"></a>Explication détaillée du fonctionnement de la mise en cache

Il n’existe pas de valeur de bande passante spécifique lors de l’ajout du CDN, car la quantité de bande passante nécessaire pour un point de terminaison de streaming avec CDN varie. Cela dépend beaucoup du type de contenu, du nombre de visiteurs, de la vitesse de transmission et des protocoles. Le CDN met en cache seulement ce qui est demandé. Cela signifie que le contenu qui est souvent demandé est fourni directement par le CDN, tant que le fragment vidéo est mis en cache. Le contenu en direct est susceptible d’être mis en cache, car en général, beaucoup de gens regardent exactement la même chose. Le contenu à la demande peut être plus problématique, car vous pouvez avoir du contenu avec une demande forte et du contenu peu demandé. Si vous avez des millions de ressources vidéo avec peu de demandes de visualisation (seulement 1 ou 2 visiteurs par semaine), mais que vous avez des milliers de personnes regardant chacune des vidéos différentes, le CDN devient beaucoup moins efficace. Avec ces absences dans le cache, vous augmentez la charge sur le point de terminaison de streaming.
 
Vous devez également prendre en compte le fonctionnement du streaming adaptif. Chaque fragment vidéo individuel est mis en cache comme entité propre. Par exemple si, la première fois qu’une certaine vidéo est regardée, la personne ne regarde que quelques secondes ici et là, seuls les fragments vidéo associés à ce que la personne a regardé sont mis en cache dans le CDN. Avec le streaming adaptatif, vous avez en général 5 à 7 vitesses de transmission de vidéo différentes. Si une personne regarde à une certaine vitesse de transmission et qu’une autre personne regarde à une autre vitesse de transmission, le contenu qu’ils regardent chacun est mis en cache séparément dans le CDN. Même si deux personnes regardent du contenu à la même vitesse de transmission, leur streaming peut se faire via des protocoles différents. Chaque protocole (HLS, MPEG-DASH, Smooth Streaming) est mis en cache séparément. Ainsi, chaque vitesse de transmission et chaque protocole sont mis en cache séparément, et seuls les fragments vidéo qui ont été demandés sont mis en cache.
 
## <a name="streamingendpoint-properties"></a>Propriétés du point de terminaison de streaming 

Cette section fournit des détails sur certaines propriétés du point de terminaison de streaming. Pour obtenir des exemples montrant comment créer un nouveau point de terminaison de streaming et les descriptions de toutes les propriétés, consultez [Point de terminaison de streaming](https://docs.microsoft.com/rest/api/media/streamingendpoints/create). 

|Propriété|Description|  
|--------------|----------|
|`accessControl`|Utilisée pour configurer les paramètres de sécurité suivants pour ce point de terminaison de streaming : les clés d’authentification d’en-tête de signature Akamai et les adresses IP qui sont autorisées à se connecter à ce point de terminaison.<br />Cette propriété peut être définie quand `cdnEnabled` est défini sur false.|  
|`cdnEnabled`|Indique si l’intégration d’Azure CDN pour ce point de terminaison de streaming est ou non activée (elle est désactivée par défaut).<br /><br /> Si vous définissez `cdnEnabled` sur true, les configurations suivantes sont désactivées : `customHostNames` et `accessControl`.<br /><br />Certains centres de données ne prennent pas en charge l’intégration d’Azure CDN. Pour vérifier si l’intégration d’Azure CDN est disponible pour votre centre de données, procédez comme suit :<br /><br /> - Essayez de définir `cdnEnabled` sur true.<br /><br /> - Vérifiez le résultat retourné pour `HTTP Error Code 412` (PreconditionFailed) avec un message de « La propriété CdnEnabled du point de terminaison de streaming ne peut pas être définie sur true, car la fonctionnalité CDN n’est pas disponible dans la région actuelle. »<br /><br /> Si vous recevez cette erreur, cela signifie que le centre de données ne la prend pas en charge. Vous devez essayer un autre centre de données.|  
|`cdnProfile`|Quand `cdnEnabled` est définie sur true, vous pouvez également passer des valeurs de `cdnProfile` valeurs. `cdnProfile` est le nom du profil CDN où le point du point de terminaison CDN doit être créé. Vous pouvez fournir un cdnProfile existant ou en utiliser un nouveau. Si la valeur est NULL et que `cdnEnabled` est true, la valeur par défaut « AzureMediaStreamingPlatformCdnProfile » est utilisée. Si le `cdnProfile` fourni existe déjà, un point de terminaison est créé sous celui-ci. Si le profil n’existe pas, un nouveau profil est créé automatiquement.|
|`cdnProvider`|Quand le CDN est activé, vous pouvez également passer des valeurs de `cdnProvider`. `cdnProvider` contrôle les fournisseurs à utiliser. Actuellement, trois valeurs sont prises en charge : « StandardVerizon », « PremiumVerizon » et « StandardAkamai ». Si aucune valeur n’est fournie et que `cdnEnabled` a la valeur true, « StandardVerizon » est utilisé (c’est la valeur par défaut).|
|`crossSiteAccessPolicies`|Utilisée pour spécifier des stratégies d’accès entre sites pour différents clients. Pour plus d’informations, consultez [Cross-domain policy file specification](http://www.adobe.com/devnet/articles/crossdomain_policy_file_spec.html) et [Rendre un service disponible entre des limites de domaine](http://msdn.microsoft.com/library/cc197955\(v=vs.95\).aspx).|  
|`customHostNames`|Utilisée pour configurer un point de terminaison de streaming de pour qu’il accepte le trafic dirigé vers un nom d’hôte personnalisé. Ceci permet une configuration plus facile de la gestion du trafic via un gestionnaire de trafic global, ainsi que l’utilisation de noms de domaines personnalisés comme nom du point de terminaison de streaming.<br /><br /> La propriété du nom de domaine doit être vérifiée par Azure Media Services. Azure Media Services vérifie la propriété du nom de domaine en demandant un enregistrement `CName` qui contient l’ID de compte Azure Media Services comme composant à ajouter au domaine utilisé. Par exemple, pour utiliser « sports.contoso.com » comme nom d’hôte personnalisé pour le point de terminaison de streaming, un enregistrement pour `<accountId>.contoso.com` doit être configuré de façon à pointer vers un des noms d’hôte de vérification de Media Services. Le nom d’hôte de vérification est composé de verifydns.\<mediaservices-dns-zone>. Le tableau suivant contient les zones DNS attendues dans l’enregistrement de vérification pour les différentes régions Azure.<br /><br /> Amérique du Nord, Europe, Singapour, Hong Kong, Japon :<br /><br /> - mediaservices.windows.net<br /><br /> - verifydns.mediaservices.windows.net<br /><br /> Chine :<br /><br /> - mediaservices.chinacloudapi.cn<br /><br /> - verifydns.mediaservices.chinacloudapi.cn<br /><br /> Par exemple, un enregistrement `CName` qui mappe « 945a4c4e-28ea-45cd-8ccb-a519f6b700ad.contoso.com » à « verifydns.mediaservices.windows.net » prouve que l’ID Azure Media Services 945a4c4e-28ea-45cd-8ccb-a519f6b700ad est propriétaire du domaine contoso.com, permettant ainsi l’utilisation de n’importe quel nom sous contoso.com comme nom d’hôte personnalisé pour un point de terminaison de streaming sous ce compte.<br /><br /> Pour rechercher la valeur de l’ID du Service multimédia, accédez au [portail Azure](https://portal.azure.com/) et sélectionnez votre compte Service multimédia. L’ID DE SERVICE MULTIMÉDIA apparaît à droite de la page TABLEAU DE BORD.<br /><br /> **Avertissement** : Si vous tentez de définir un nom d’hôte personnalisé sans une vérification appropriée de l’enregistrement `CName`, la réponse DNS échoue, puis elle est mise en cache pendant un certain temps. Une fois qu’un enregistrement approprié est en place, un certain temps peut être nécessaire pour que la réponse mise en cache soit revalidée. Selon le fournisseur DNS pour le domaine personnalisé, quelques minutes à une heure peuvent être nécessaires pour revalider l’enregistrement.<br /><br /> En plus du `CName` qui mappe `<accountId>.<parent domain>` à `verifydns.<mediaservices-dns-zone>`, vous devez créer un autre `CName` qui mappe le nom d’hôte personnalisé (par exemple `sports.contoso.com`) au nom d’hôte de votre point de terminaison de streaming Media Services (par exemple `amstest.streaming.mediaservices.windows.net`).<br /><br /> **Remarque** : Des points de terminaison de streaming qui se trouvent dans le même centre de données ne peuvent pas partager le même nom d’hôte personnalisé.<br /> Cette propriété est valide pour les points de terminaison de streaming Standard et Premium, et elle peut être définie quand « cdnEnabled » est définie sur false<br/><br/> Actuellement, AMS ne prend pas en charge SSL avec les domaines personnalisés.  |  
|`maxCacheAge`|Remplace l’en-tête de contrôle du cache HTTP max-age par défaut défini par le point de terminaison de streaming sur des fragments de médias et des manifestes à la demande. La valeur est définie en secondes.|
|`resourceState`|Les valeurs de la propriété peuvent être :<br /><br /> - Arrêté. État initial d’un point de terminaison de streaming après sa création.<br /><br /> - Démarrage en cours. Le point de terminaison de streaming est en transition vers l’état « Exécution en cours ».<br /><br /> - Exécution en cours. Le point de terminaison de streaming peut diffuser du contenu aux clients.<br /><br /> - Mise à l’échelle. Les unités d’échelle sont augmentées ou diminuées.<br /><br /> - Arrêt en cours. Le point de terminaison de streaming est en transition vers l’état « Arrêté ».<br/><br/> - Suppression en cours. Le point de terminaison de streaming est en cours de suppression.|
|`scaleUnits `|Les unités d’échelle vous fournissent une capacité de sortie dédiée qui peut être achetée par incréments de 200 Mbits/s. Si vous devez passer à un type **Premium**, ajustez `scaleUnits`. |

## <a name="next-steps"></a>Étapes suivantes

L’exemple [de ce dépôt](https://github.com/Azure-Samples/media-services-v3-dotnet-quickstarts/blob/master/AMSV3Quickstarts/EncodeAndStreamFiles/Program.cs) montre comment démarrer le point de terminaison de streaming par défaut avec .NET.

